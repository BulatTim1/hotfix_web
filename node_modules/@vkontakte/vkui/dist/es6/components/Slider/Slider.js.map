{"version":3,"sources":["../../../../src/components/Slider/Slider.js"],"names":["React","Component","PropTypes","Touch","classNames","getClassName","baseClassNames","precisionRound","number","precision","factor","Math","pow","round","Slider","props","e","absolutePosition","validateAbsolute","startX","state","containerLeft","percentPosition","absoluteToPecent","onChange","percentToValue","isControlledOutside","setState","active","originalEvent","target","closest","shiftX","preventDefault","callback","container","offsetLeft","containerWidth","offsetWidth","getRootRef","current","hasOwnProperty","value","absolute","res","max","min","step","stepCount","absStep","percent","stepFloatPart","split","length","window","addEventListener","onResize","validatePercent","valueToPercent","prevProps","removeEventListener","className","defaultValue","restProps","getRef","onStart","onMoveX","onEnd","width","func","string","style","object","oneOfType","shape","any"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Touch from '../Touch/Touch';\nimport classNames from '../../lib/classNames';\nimport getClassName from '../../helpers/getClassName';\n\nconst baseClassNames = getClassName('Slider');\n\nfunction precisionRound (number, precision) {\n  let factor = Math.pow(10, precision || 1);\n  return Math.round(number * factor) / factor;\n}\n\nexport default class Slider extends Component {\n  constructor (props) {\n    super(props);\n    this.state = {\n      startX: 0\n    };\n    this.isControlledOutside = this.props.hasOwnProperty('value');\n  }\n\n  static propTypes = {\n    min: PropTypes.number,\n    max: PropTypes.number,\n    value: PropTypes.number,\n    step: PropTypes.number,\n    onChange: PropTypes.func,\n    defaultValue: PropTypes.number,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    getRootRef: PropTypes.oneOfType([\n      PropTypes.func,\n      PropTypes.shape({ current: PropTypes.any })\n    ])\n  };\n\n  static defaultProps = {\n    min: 0,\n    max: 100,\n    step: 0\n  };\n\n  onStart = e => {\n    const absolutePosition = this.validateAbsolute(e.startX - this.state.containerLeft);\n    const percentPosition = this.absoluteToPecent(absolutePosition);\n\n    this.onChange(this.percentToValue(percentPosition), e);\n\n    if (this.isControlledOutside) {\n      this.setState({ startX: absolutePosition });\n    } else {\n      this.setState({\n        startX: absolutePosition,\n        percentPosition\n      });\n    }\n\n    this.setState({ active: !!e.originalEvent.target.closest('.Slider__thumb') });\n  };\n\n  onMoveX = e => {\n    const absolutePosition = this.validateAbsolute(this.state.startX + (e.shiftX || 0));\n    const percentPosition = this.absoluteToPecent(absolutePosition);\n\n    this.onChange(this.percentToValue(percentPosition), e);\n\n    if (!this.isControlledOutside) {\n      this.setState({ percentPosition });\n    }\n\n    e.originalEvent.preventDefault();\n  };\n\n  onEnd = () => {\n    this.setState({\n      active: false\n    });\n  };\n\n  onResize = (callback) => {\n    this.setState({\n      containerLeft: this.container.offsetLeft,\n      containerWidth: this.container.offsetWidth\n    }, () => {\n      typeof callback === 'function' && callback();\n    });\n  };\n\n  onChange (value, e) {\n    this.props.onChange && this.props.onChange(value, e);\n  }\n\n  validateAbsolute (absolute) {\n    let res = Math.max(0, Math.min(absolute, this.state.containerWidth));\n\n    if (this.props.step > 0) {\n      const stepCount = (this.props.max - this.props.min) / this.props.step;\n      const absStep = this.state.containerWidth / stepCount;\n\n      res = Math.round(res / absStep) * absStep;\n    }\n\n    return res;\n  }\n\n  validatePercent (percent) { return Math.max(0, Math.min(percent, 100)); }\n\n  absoluteToPecent (absolute) { return absolute * 100 / this.state.containerWidth; }\n\n  percentToValue (percent) {\n    const res = percent * (this.props.max - this.props.min) / 100 + this.props.min;\n    if (this.props.step > 0) {\n      const stepFloatPart = `${this.props.step}`.split('.')[1] || '';\n      return precisionRound(res, stepFloatPart.length);\n    }\n    return res;\n  }\n\n  valueToPercent (value) { return (value - this.props.min) * 100 / (this.props.max - this.props.min); }\n\n  get value () {\n    if (this.isControlledOutside) {\n      return this.props.value;\n    } else if (this.props.hasOwnProperty('defaultValue')) {\n      return this.props.defaultValue;\n    } else {\n      return this.props.min;\n    }\n  }\n\n  componentDidMount () {\n    window.addEventListener('resize', this.onResize);\n    this.onResize(() => {\n      this.setState({ percentPosition: this.validatePercent(this.valueToPercent(this.value)) });\n    });\n  }\n\n  componentDidUpdate (prevProps) {\n    if (this.isControlledOutside && this.props.value !== prevProps.value) {\n      this.setState({ percentPosition: this.validatePercent(this.valueToPercent(this.props.value)) });\n    }\n  }\n\n  componentWillUnmount () {\n    window.removeEventListener('resize', this.onResize);\n  }\n\n  getRef = container => {\n    this.container = container;\n\n    const getRootRef = this.props.getRootRef;\n    if (getRootRef) {\n      if (typeof getRootRef === 'function') {\n        getRootRef(container);\n      } else {\n        getRootRef.current = container;\n      }\n    }\n  };\n\n  render () {\n    const { className, min, max, step, value, defaultValue, onChange, getRootRef, ...restProps } = this.props;\n\n    return (\n      <div {...restProps} className={classNames(baseClassNames, className)} ref={this.getRef}>\n        <Touch onStart={this.onStart} onMoveX={this.onMoveX} onEnd={this.onEnd} className=\"Slider__in\">\n          <div className=\"Slider__dragger\" style={{ width: this.state.percentPosition + '%' }}>\n            <span\n              className={classNames('Slider__thumb', 'Slider__thumb--end', {\n                'Slider__thumb--active': this.state.active\n              })}\n            />\n          </div>\n        </Touch>\n      </div>\n    );\n  }\n}\n"],"file":"Slider.js"}