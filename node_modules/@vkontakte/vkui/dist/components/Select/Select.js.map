{"version":3,"sources":["../../../src/components/Select/Select.tsx"],"names":["Select","props","e","setTitle","isControlledOutside","setState","value","currentTarget","onChange","selectedOption","selectEl","options","selectedIndex","title","text","notSelected","hasOwnProperty","element","getRef","current","state","defaultValue","prevProps","children","style","alignment","status","placeholder","className","getRootRef","restProps","Component"],"mappings":"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","sourcesContent":["import React, { Component, HTMLAttributes } from 'react';\nimport classNames from '../../lib/classNames';\nimport Icon24Dropdown from '@vkontakte/icons/dist/24/dropdown';\nimport FormField from '../FormField/FormField';\nimport { HasChildren, HasFormStatus, HasRef, HasRootRef } from '../../types/props';\n\nexport interface SelectProps extends\n  HTMLAttributes<HTMLSelectElement>,\n  HasRef<HTMLSelectElement>,\n  HasRootRef<HTMLLabelElement>,\n  HasChildren,\n  HasFormStatus\n{\n  value?: string;\n  placeholder?: string;\n  alignment?: 'left' | 'center' | 'top';\n  disabled?: boolean;\n}\n\nexport interface SelectState {\n  value?: string,\n  title?: string,\n  notSelected?: boolean,\n}\n\nexport default class Select extends Component<SelectProps, SelectState> {\n  constructor (props) {\n    super(props);\n    const state: SelectState = {\n      title: '',\n      notSelected: false\n    };\n    if (typeof props.value !== 'undefined') {\n      this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n    this.state = state;\n  }\n\n  isControlledOutside?: boolean\n  selectEl?: HTMLSelectElement\n\n  onChange = (e: React.FormEvent<HTMLSelectElement>) => {\n    this.setTitle();\n    if (!this.isControlledOutside) {\n      this.setState({ value: e.currentTarget.value });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  };\n\n  setTitle = () => {\n    const selectedOption = this.selectEl.options[this.selectEl.selectedIndex];\n    selectedOption && this.setState({\n      title: selectedOption.text,\n      notSelected: selectedOption.value === '' && this.props.hasOwnProperty('placeholder')\n    });\n  };\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.value !== this.props.value || prevProps.children !== this.props.children) {\n      this.setTitle();\n    }\n  }\n\n  componentDidMount () {\n    this.setTitle();\n  }\n\n  get value () {\n    return this.isControlledOutside ? this.props.value : this.state.value;\n  }\n\n  getRef = (element) => {\n    this.selectEl = element;\n\n    const getRef = this.props.getRef;\n    if (getRef) {\n      if (typeof getRef === 'function') {\n        getRef(element);\n      } else {\n        getRef.current = element;\n      }\n    }\n  };\n\n  render () {\n    const { style, value, defaultValue, onChange, alignment, status, placeholder, children, className,\n      getRef, getRootRef, ...restProps } = this.props;\n\n    return (\n      <FormField\n        TagName=\"label\"\n        className={classNames('Select', {\n          [`Select--not-selected`]: this.state.notSelected,\n          [`Select--align-${alignment}`]: !!alignment\n        }, className)}\n        style={style}\n        getRootRef={getRootRef}\n        status={status}\n      >\n        <select\n          {...restProps}\n          className=\"Select__el\"\n          onChange={this.onChange}\n          value={this.value}\n          ref={this.getRef}\n        >\n          {placeholder && <option value=\"\">{placeholder}</option>}\n          {children}\n        </select>\n        <div className=\"Select__container\">\n          <div className=\"Select__title\">{this.state.title}</div>\n          <Icon24Dropdown />\n        </div>\n      </FormField>\n    );\n  }\n}\n"],"file":"Select.js"}