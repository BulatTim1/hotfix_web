{"version":3,"sources":["../../../src/components/Tooltip/Tooltip.js"],"names":["isElement","element","React","isValidElement","isDOMTypeElement","type","baseClassName","TooltipPortal","x","y","findPortalTarget","el","target","props","closestFixed","closest","closestHeader","closestPanel","document","getElementById","context","panel","childNodes","fixedPortal","targetBounds","getBoundingClientRect","portalBounds","portalTarget","width","height","left","top","removeEventListener","onClose","offsetY","offsetX","alignX","alignY","coords","getBoundingTargetRect","addEventListener","setState","offsetWidth","offsetHeight","title","text","cornerOffset","ReactDOM","createPortal","state","getRef","Component","PropTypes","object","node","oneOf","number","func","isRequired","any","string","Tooltip","ready","targetEl","children","isShown","portalProps","child","cloneElement","bool"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport getClassName from '../../helpers/getClassName';\nimport ReactDOM from 'react-dom';\n\nconst isElement = element => React.isValidElement(element);\nconst isDOMTypeElement = element => isElement(element) && typeof element.type === 'string';\nconst baseClassName = getClassName('Tooltip');\n\nclass TooltipPortal extends React.Component {\n  static propTypes = {\n    target: PropTypes.object,\n    text: PropTypes.node,\n    title: PropTypes.node,\n    alignX: PropTypes.oneOf(['left', 'right']),\n    alignY: PropTypes.oneOf(['top', 'bottom']),\n    offsetX: PropTypes.number,\n    offsetY: PropTypes.number,\n    cornerOffset: PropTypes.number,\n    onClose: PropTypes.func.isRequired\n  };\n\n  static contextTypes = {\n    document: PropTypes.any,\n    panel: PropTypes.string\n  };\n\n  state = {\n    x: 0,\n    y: 0\n  };\n\n  get document () {\n    return this.context.document || document;\n  }\n\n  fixedPortal = false;\n\n  portalTarget = this.findPortalTarget();\n\n  findPortalTarget () {\n    const { target } = this.props;\n    const closestFixed = target.closest('.FixedLayout');\n    const closestHeader = target.closest('.PanelHeader__in');\n    const closestPanel = this.document.getElementById(this.context.panel).childNodes[0];\n\n    if (closestFixed || closestHeader) {\n      this.fixedPortal = true;\n    }\n\n    return closestFixed || closestHeader || closestPanel;\n  }\n\n  getBoundingTargetRect () {\n    const { target } = this.props;\n    const targetBounds = target.getBoundingClientRect();\n    const portalBounds = this.portalTarget.getBoundingClientRect();\n\n    return {\n      width: targetBounds.width,\n      height: targetBounds.height,\n      x: targetBounds.left - portalBounds.left,\n      y: targetBounds.top - portalBounds.top\n    };\n  }\n\n  componentWillUnmount () {\n    this.document.removeEventListener('click', this.props.onClose);\n  }\n\n  componentDidMount () {\n    const { offsetY, offsetX, alignX, alignY } = this.props;\n    const coords = this.getBoundingTargetRect();\n\n    this.document.addEventListener('click', this.props.onClose);\n\n    this.setState({\n      x: coords.x + offsetX + (alignX === 'right' ? coords.width - this.el.offsetWidth : 0),\n      y: coords.y + (alignY === 'top' ? -this.el.offsetHeight - offsetY : coords.height + offsetY)\n    });\n  }\n\n  getRef = el => this.el = el;\n\n  render () {\n    const { title, text, alignX, alignY, cornerOffset } = this.props;\n\n    return ReactDOM.createPortal(\n      <div className={classNames(baseClassName, {\n        [`Tooltip--x-${alignX}`]: true,\n        [`Tooltip--y-${alignY}`]: true,\n        'Tooltip--fixed': this.fixedPortal\n      })}>\n        <div className=\"Tooltip__container\" style={{ top: this.state.y, left: this.state.x }} ref={this.getRef}>\n          <div className=\"Tooltip__corner\" style={{ [alignX]: 20 + cornerOffset }}/>\n          <div className=\"Tooltip__content\">\n            {title && <div className=\"Tooltip__title\">{title}</div>}\n            {text && <div className=\"Tooltip__text\">{text}</div>}\n          </div>\n        </div>\n      </div>, this.portalTarget);\n  }\n}\n\nexport default class Tooltip extends React.Component {\n  static propTypes = {\n    /**\n     * **Важно**: если в `children` передан React-компонент, то необходимо убедиться в том, что он поддерживает\n     * свойство `getRootRef`, которое должно возвращаться ссылку на корневой DOM-элемент компонента,\n     * иначе тултип показан не будет. Если передан React-element, то такой проблемы нет.\n     */\n    children: PropTypes.node.isRequired,\n    /**\n     * Если передан `false`, то рисуется просто `children`.\n     */\n    isShown: PropTypes.bool.isRequired,\n    /**\n     * Текст тултипа.\n     */\n    text: PropTypes.node,\n    /**\n     * Заголовок тултипа.\n     */\n    title: PropTypes.node,\n    /**\n     * Положение по горизонтали (прижатие к левому или правому краю `children`).\n     */\n    alignX: PropTypes.oneOf(['left', 'right']),\n    /**\n     * Положение по вертикали (расположение над или под `children`).\n     */\n    alignY: PropTypes.oneOf(['top', 'bottom']),\n    /**\n     * Сдвиг по горизонтали (относительно портала, в котором рисуется тултип).\n     */\n    offsetX: PropTypes.number,\n    /**\n     * Сдвиг по вертикали (относительно портала, в котором рисуется тултип).\n     */\n    offsetY: PropTypes.number,\n    /**\n     * Сдвиг треугольника (относительно ширины тултипа).\n     */\n    cornerOffset: PropTypes.number,\n    /**\n     * Callback, который вызывается при клике по любому месту в пределах экрана.\n     */\n    onClose: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    offsetX: 0,\n    offsetY: 15,\n    alignX: 'left',\n    alignY: 'bottom',\n    cornerOffset: 0,\n    isShown: true\n  };\n\n  state = {\n    ready: false\n  };\n\n  componentDidMount () {\n    this.targetEl && this.setState({ ready: true });\n  }\n\n  getRef = el => this.targetEl = el;\n\n  render () {\n    const { children, isShown, ...portalProps } = this.props;\n\n    const child = React.cloneElement(children, {\n      [isDOMTypeElement(children) ? 'ref' : 'getRootRef']: this.getRef, key: 'c'\n    });\n\n    if (!isShown || !this.state.ready) {\n      return child;\n    }\n\n    return [child, <TooltipPortal {...portalProps} target={this.targetEl} key=\"t\" />];\n  }\n}\n"],"file":"Tooltip.js"}